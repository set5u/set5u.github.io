import"./CR__Ohlt.js";import"./B-pl63Pz.js";import{cg as T}from"./Dr010rql.js";function d(e,l){(l==null||l>e.length)&&(l=e.length);for(var n=0,a=new Array(l);n<l;n++)a[n]=e[n];return a}function D(e){if(Array.isArray(e))return d(e)}function H(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function S(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(e){return D(e)||H(e)||L(e)||S()}function L(e,l){if(e){if(typeof e=="string")return d(e,l);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,l)}}function z(e){return e.split(" ").filter(function(l){return l!==""}).map(function(l){return parseFloat(l)})}function V(e,l,n){for(;n.length!==l;){var a,r=z(e.lines[e.index++]);(a=n).push.apply(a,C(r))}}function k(e,l,n){for(var a=0,r=0,t=0,u=0,f=0,g=0,i=0;i<e.numberOfHorizontalAngles-1;i++)if(n<e.horizontalAngles[i+1]||i===e.numberOfHorizontalAngles-2){r=i,t=e.horizontalAngles[i],u=e.horizontalAngles[i+1];break}for(var o=0;o<e.numberOfVerticalAngles-1;o++)if(l<e.verticalAngles[o+1]||o===e.numberOfVerticalAngles-2){a=o,f=e.verticalAngles[o],g=e.verticalAngles[o+1];break}var s=u-t,h=g-f;if(h===0)return 0;var m=s===0?0:(n-t)/s,b=(l-f)/h,c=s===0?r:r+1,O=T(e.candelaValues[r][a],e.candelaValues[c][a],m),A=T(e.candelaValues[r][a+1],e.candelaValues[c][a+1],m),p=T(O,A,b);return p}function E(e){var l=new TextDecoder("utf-8"),n=l.decode(e),a={lines:n.split(`
`),index:0},r={version:a.lines[0],candelaValues:[],horizontalAngles:[],verticalAngles:[],numberOfHorizontalAngles:0,numberOfVerticalAngles:0};for(a.index=1;a.lines.length>0&&!a.lines[a.index].includes("TILT=");)a.index++;a.lines[a.index].includes("INCLUDE"),a.index++;var t=z(a.lines[a.index++]);r.numberOfLights=t[0],r.lumensPerLamp=t[1],r.candelaMultiplier=t[2],r.numberOfVerticalAngles=t[3],r.numberOfHorizontalAngles=t[4],r.photometricType=t[5],r.unitsType=t[6],r.width=t[7],r.length=t[8],r.height=t[9];var u=z(a.lines[a.index++]);r.ballastFactor=u[0],r.fileGenerationType=u[1],r.inputWatts=u[2];for(var f=0;f<r.numberOfHorizontalAngles;f++)r.candelaValues[f]=[];V(a,r.numberOfVerticalAngles,r.verticalAngles),V(a,r.numberOfHorizontalAngles,r.horizontalAngles);for(var g=0;g<r.numberOfHorizontalAngles;g++)V(a,r.numberOfVerticalAngles,r.candelaValues[g]);for(var i=-1,o=0;o<r.numberOfHorizontalAngles;o++)for(var s=0;s<r.numberOfVerticalAngles;s++)r.candelaValues[o][s]*=r.candelaValues[o][s]*r.candelaMultiplier*r.ballastFactor*r.fileGenerationType,i=Math.max(i,r.candelaValues[o][s]);if(i>0)for(var h=0;h<r.numberOfHorizontalAngles;h++)for(var m=0;m<r.numberOfVerticalAngles;m++)r.candelaValues[h][m]/=i;for(var b=180,c=b*2,O=c*b,A=new Float32Array(c*b),p=r.horizontalAngles[0],y=r.horizontalAngles[r.numberOfHorizontalAngles-1],_=0;_<O;_++){var v=_%c,w=Math.floor(_/c);y-p!==0&&(v<p||v>=y)&&(v%=y*2,v>y&&(v=y*2-v)),A[w+v*b]=k(r,w,v)}return{width:c/2,height:1,data:A}}function P(e,l){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}function I(e,l){for(var n=0;n<l.length;n++){var a=l[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function M(e,l,n){return I(e.prototype,l),e}var G=function(){function e(){P(this,e),this.supportCascades=!1}return M(e,[{key:"loadCubeData",value:function(){throw".ies not supported in Cube."}},{key:"loadData",value:function(n,a,r){var t=new Uint8Array(n.buffer,n.byteOffset,n.byteLength),u=E(t);r(u.width,u.height,!1,!1,function(){var f=a.getEngine();a.type=1,a.format=6,a._gammaSpace=!1,f._uploadDataToTextureDirectly(a,u.data)})}}]),e}();export{G as _IESTextureLoader};
